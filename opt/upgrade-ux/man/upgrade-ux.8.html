<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='content-type' content='text/html;charset=utf8'>
  <meta name='generator' content='Ronn-NG/v0.9.1 (http://github.com/apjanke/ronn-ng/tree/0.9.1)'>
  <title>upgrade-ux(8) - a framework to update or patch an Unix system (Linux, HP-UX and Solaris)</title>
  <style type='text/css' media='all'>
  /* style: man */
  body#manpage {margin:0}
  .mp {max-width:100ex;padding:0 9ex 1ex 4ex}
  .mp p,.mp pre,.mp ul,.mp ol,.mp dl {margin:0 0 20px 0}
  .mp h2 {margin:10px 0 0 0}
  .mp > p,.mp > pre,.mp > ul,.mp > ol,.mp > dl {margin-left:8ex}
  .mp h3 {margin:0 0 0 4ex}
  .mp dt {margin:0;clear:left}
  .mp dt.flush {float:left;width:8ex}
  .mp dd {margin:0 0 0 9ex}
  .mp h1,.mp h2,.mp h3,.mp h4 {clear:left}
  .mp pre {margin-bottom:20px}
  .mp pre+h2,.mp pre+h3 {margin-top:22px}
  .mp h2+pre,.mp h3+pre {margin-top:5px}
  .mp img {display:block;margin:auto}
  .mp h1.man-title {display:none}
  .mp,.mp code,.mp pre,.mp tt,.mp kbd,.mp samp,.mp h3,.mp h4 {font-family:monospace;font-size:14px;line-height:1.42857142857143}
  .mp h2 {font-size:16px;line-height:1.25}
  .mp h1 {font-size:20px;line-height:2}
  .mp {text-align:justify;background:#fff}
  .mp,.mp code,.mp pre,.mp pre code,.mp tt,.mp kbd,.mp samp {color:#131211}
  .mp h1,.mp h2,.mp h3,.mp h4 {color:#030201}
  .mp u {text-decoration:underline}
  .mp code,.mp strong,.mp b {font-weight:bold;color:#131211}
  .mp em,.mp var {font-style:italic;color:#232221;text-decoration:none}
  .mp a,.mp a:link,.mp a:hover,.mp a code,.mp a pre,.mp a tt,.mp a kbd,.mp a samp {color:#0000ff}
  .mp b.man-ref {font-weight:normal;color:#434241}
  .mp pre {padding:0 4ex}
  .mp pre code {font-weight:normal;color:#434241}
  .mp h2+pre,h3+pre {padding-left:0}
  ol.man-decor,ol.man-decor li {margin:3px 0 10px 0;padding:0;float:left;width:33%;list-style-type:none;text-transform:uppercase;color:#999;letter-spacing:1px}
  ol.man-decor {width:100%}
  ol.man-decor li.tl {text-align:left}
  ol.man-decor li.tc {text-align:center;letter-spacing:4px}
  ol.man-decor li.tr {text-align:right;float:right}
  </style>
</head>
<!--
  The following styles are deprecated and will be removed at some point:
  div#man, div#man ol.man, div#man ol.head, div#man ol.man.

  The .man-page, .man-decor, .man-head, .man-foot, .man-title, and
  .man-navigation should be used instead.
-->
<body id='manpage'>
  <div class='mp' id='man'>

  <div class='man-navigation' style='display:none'>
    <a href="#NAME">NAME</a>
    <a href="#SYNOPSIS">SYNOPSIS</a>
    <a href="#DESCRIPTION">DESCRIPTION</a>
    <a href="#OPTIONS">OPTIONS</a>
    <a href="#CONFIGURATION">CONFIGURATION</a>
    <a href="#INI-FILES">INI FILES</a>
    <a href="#EXIT-STATUS">EXIT STATUS</a>
    <a href="#FILES">FILES</a>
    <a href="#BUGS">BUGS</a>
    <a href="#COPYRIGHT">COPYRIGHT</a>
  </div>

  <ol class='man-decor man-head man head'>
    <li class='tl'>upgrade-ux(8)</li>
    <li class='tc'></li>
    <li class='tr'>upgrade-ux(8)</li>
  </ol>

  

<h2 id="NAME">NAME</h2>
<p class="man-name">
  <code>upgrade-ux</code> - <span class="man-whatis">a framework to update or patch an Unix system (Linux, HP-UX and Solaris)</span>
</p>
<h2 id="SYNOPSIS">SYNOPSIS</h2>

<p><code>upgrade-ux</code> [<strong>-dDsSpFvV</strong>] [<strong>-c DIR</strong>] <em>COMMAND</em> [-- <em>ARGS</em>...]</p>

<h2 id="DESCRIPTION">DESCRIPTION</h2>

<p>Upgrade-ux is an Open Source upgrade framework to make patching and upgrades easy and repeatable.</p>

<p>Extending upgrade-ux is made possible by its modular (ksh) framework.
Consistent logging and optionally extended output help understand the concepts
behind Upgrade-ux and help debug during development.</p>

<p>Upgrade-ux comes with ABSOLUTELY NO WARRANTY; for details see
the GNU General Public License at: https://www.gnu.org/licenses/gpl.html</p>

<h2 id="OPTIONS">OPTIONS</h2>

<h3 id="GLOBAL-OPTIONS">GLOBAL OPTIONS</h3>

<dl>
<dt>
<code>-c</code> <em>DIR</em>
</dt>
<dd>alternative config directory; instead of <code>/etc/opt/upgrade-ux</code>
</dd>
<dt><code>-p</code></dt>
<dd>
<em>preview mode</em> (we will not remove or install, update any software on this system)
A preview will be forced by <em>upgrade-ux</em> before we can start an upgrade for real!</dd>
<dt><code>-d</code></dt>
<dd>
<em>debug mode</em> (log debug messages to log file)</dd>
<dt><code>-D</code></dt>
<dd>
<em>debugscript mode</em> (log every function call)</dd>
<dt><code>-s</code></dt>
<dd>
<em>simulation mode</em> (show what scripts rear would include)</dd>
<dt><code>-S</code></dt>
<dd>
<em>step-by-step mode</em> (acknowledge each script individually)</dd>
<dt><code>-F</code></dt>
<dd>
<em>forced</em> continuation during preview or upgrade mode when check_patches returns errors</dd>
<dt><code>-v</code></dt>
<dd>
<em>verbose output</em> (show progress output)</dd>
<dt><code>-V</code></dt>
<dd>version information</dd>
</dl>

<h3 id="COMMANDS">COMMANDS</h3>

<dl>
<dt><em>dump</em></dt>
<dd>  dump configuration and system information; please run this to verify
  your setup</dd>
<dt><em>help</em></dt>
<dd>  print full list of commands and options</dd>
<dt><em>purgelogs</em></dt>
<dd>  remove log files older then 30 days</dd>
<dt><em>mkdist</em></dt>
<dd>  creates a tar archive of upgrade-ux</dd>
<dt><em>test</em></dt>
<dd>  a simple test flow (stale NFS test)</dd>
<dt><em>upgrade</em></dt>
<dd>  the default command (when no command given) which will launch the upgrade/update/patch procedure</dd>
</dl>

<p>Use <code>upgrade-ux -v help</code> for more advanced commands.</p>

<h2 id="CONFIGURATION">CONFIGURATION</h2>

<p>There are several configuration files available under (<em>/etc/opt/upgrade-ux/</em>):</p>

<dl>
<dt><em>default.conf</em></dt>
<dd>  the default configuration file which defines parameters and variables. You should not change anything in here. If you need to modify a parameter then copy that line into the <em>local.conf</em> file.</dd>
<dt><em>local.conf</em></dt>
<dd>  the local configuration file meant for the end-user. Remember, configuration files should be treated as shell scripts.</dd>
<dt><em>HP-UX.conf</em></dt>
<dd>  parameters and settings only read by HP-UX systems</dd>
<dt><em>SunOS.conf</em></dt>
<dd>  parameters and settings only read by Solaris systems</dd>
<dt><em>GNU/Linux.conf</em></dt>
<dd>  parameters and settings only read by GNU/Linux systems</dd>
<dt><em>exclude.packages</em></dt>
<dd>  the file to add packages which need to be excluded from updating</dd>
</dl>

<p>You have the choice to create additional configuration files if required. Use the <em>upgrade-ux dump</em> and check the <em>configuration tree</em> section to have a complete overview of all configuration files searched for (it is OK if these do not exist).</p>

<p>A typical variable might be the <code>YEAR</code> setting to define from which year (instead of the default <code>$(date +%Y)</code> [current year]) we want to install the patch bundles.</p>

<h2 id="INI-FILES">INI FILES</h2>

<p>Each Unix Operating System requires an <em>INI</em> file which contains the sections the upgrade procedure will follow in sequence.</p>

<p>The name of such <em>INI</em> file is build as follow:</p>

<pre><code>/etc/opt/upgrade-ux/$OS-$OS_VERSION-$YEAR.ini
</code></pre>

<p>The <em>INI</em> file is build out of sections (a section can be empty, except for the <em>[install]</em> INI section):</p>

<dl>
<dt><em>[preremove]</em></dt>
<dd>  Add here any specific command to remove specific software bundles before starting the upgrade, e.g. if some software cannot be upgrade and should be re-installed.
  Example:

    <p><code>command[0] = (command)</code></p>

    <p><code>options[0] = (options for above command)</code></p>

    <p><code>bundle[0]  = (which software to remove)</code></p>

    <p><code>version[0] = (specific version of above software bundle to be removed)</code></p>

    <p><code>command[1] = (command)</code></p>

    <p><code>...</code></p>
</dd>
<dt><em>[preinstall]</em></dt>
<dd>  Add here any specific command you want to run

    <p><code>command[0] = (command)</code></p>

    <p><code>options[0] = (options for above command)</code></p>
</dd>
<dt><em>[install]</em></dt>
<dd>  Add here all commands required to install, upgrade or patch our systems. Use the syntax:

    <p><code>command[0] = (command)</code></p>

    <p><code>options[0] = (options for above command)</code></p>

    <p><code>source[0]  = (location of the software depot)</code></p>

    <p><code>bundle[0]  = (which software to install, update)</code></p>

    <p><code>version[0] = (specific version of above software bundle to be installed or updated)</code></p>
</dd>
<dt><em>[postinstall]</em></dt>
<dd>  Add here all commands required to install additional software packages. Use the same syntax as for [install]</dd>
<dt><em>[postremove]</em></dt>
<dd>  Add here commands to remove something that could not be prevented by [install]. Syntax is the same as with [preremove]</dd>
<dt><em>[configure]</em></dt>
<dd>  Add here commands to configure something special such as cron entries. Use same syntax as [preinstall]</dd>
<dt><em>[cleanup]</em></dt>
<dd>  Add here commands to cleanup, if required. Most likely it will be empty</dd>
<dt><em>[postexecute]</em></dt>
<dd>  Add here commands to run some special, such as <em>cfg2html</em> (as an example)

    <p><code>command[0] = "/opt/cfg2html/bin/cfg2html"</code></p>

    <p><code>options[0] = "-2%Y%m%d"</code></p>
</dd>
</dl>

<h2 id="EXIT-STATUS">EXIT STATUS</h2>

<dl>
<dt><code>0</code></dt>
<dd>Successful program execution.</dd>
<dt><code>&gt;0</code></dt>
<dd>Usage, syntax or execution errors. Check the log file in
<code>/var/opt/upgrade-ux/log/</code> for more information.</dd>
</dl>

<h2 id="FILES">FILES</h2>

<dl>
<dt>/opt/upgrade-ux/bin/upgrade-ux</dt>
<dd>The program itself.</dd>
<dt>/etc/opt/upgrade-ux/default.conf</dt>
<dd>The default configuration file.</dd>
<dt>/etc/opt/upgrade-ux/local.conf</dt>
<dd>System specific configuration can be set here.</dd>
<dt>/etc/opt/upgrade-ux/exclude.packages</dt>
<dd>File contains packages to exclude from updating (one per line).</dd>
<dt>/var/opt/upgrade-ux/</dt>
<dd>Directory which contains all timestamped directories and log directory.</dd>
<dt>/var/opt/upgrade-ux/status</dt>
<dd>File containing time stamps when all sections were executed (as upgrade-ux may be restarted after a reboot and will continue where it was interrupted).</dd>
</dl>

<p>For example:</p>

<pre><code>2014-05-27 09:35:00 postexecute:ended
2014-05-27 09:35:00 preview:ended   (preview ended successfully)
</code></pre>

<dl>
<dt>/var/opt/upgrade-ux/<var>YYYY-MM-DD</var>/</dt>
<dd>Evidence files collected during <em>prep</em> phase (the <em>before</em> files) and <em>postinstall</em> phase (the <em>after</em> files) are stored under this directory.</dd>
<dt>/var/opt/upgrade-ux/log/</dt>
<dd>Directory containing all log files of each upgrade-ux run with timestamps</dd>
<dt>/tmp/upgrade-ux.xxx</dt>
<dd>Upgrade-ux working directory. By default it is removed after each run. If upgrade-ux exits with an error you probably need to remove this directory ny hand. In debugging mode the directory will not be removed as aid in helping to debug this software.</dd>
<dt>/opt/upgrade-ux/scripts</dt>
<dd>Each section will have its own directory (with the name of a section) under this directory. Under each section directory you will find sub-directories with $OS_VENDOR name. Finally, under the $OS_VENDOR directories you will find scripts (without the she-bang!) that will be executed according the flow of the script. To honor the sequence use a prefix number.</dd>
</dl>

<p>To see all scripts to be executed use the simulate option:</p>

<pre><code># /opt/upgrade-ux/bin/upgrade-ux -s
upgrade-ux 0.1 / Git
Using log file: /var/opt/upgrade-ux/log/upgrade-ux-20140506-1037-hostname.log
Source init/default/03_prepare_tmp_build_area.sh
Source init/default/05_select_ini_file.sh
Source init/default/10_check_current_status.sh
</code></pre>

<p>To run <code>upgrade-ux</code> in <em>preview</em> mode use the <code>-p</code> flag:</p>

<pre><code># /opt/upgrade-ux/bin/upgrade-ux -vp
</code></pre>

<p>To run <code>upgrade-ux</code> in <em>upgrade</em> mode then do <em>not</em> use the <code>-p</code> flag:</p>

<pre><code># /opt/upgrade-ux/bin/upgrade-ux -v
</code></pre>

<h2 id="BUGS">BUGS</h2>

<p>Feedback is welcome, please report any issues or improvements to our issue-tracker at: https://github.com/gdha/upgrade-ux/issues
Furthermore, we welcome pull requests via GitHub.</p>

<p>Be aware, that upgrade-ux is only fully developed on RHEL based Linux systems and HP-UX systems. For other GNU/Linux variants please
create an issue with your wishlist. However, new development will only be carried out via sponsoring!</p>

<h2 id="COPYRIGHT">COPYRIGHT</h2>

<p>(c) 2014 - 2025</p>

<p>Gratien Dhaese</p>

<p>Upgrade-ux comes with ABSOLUTELY NO WARRANTY; for details see the GNU General Public License at
https://www.gnu.org/licenses/gpl.html</p>

  <ol class='man-decor man-foot man foot'>
    <li class='tl'></li>
    <li class='tc'>August 2025</li>
    <li class='tr'>upgrade-ux(8)</li>
  </ol>

  </div>
</body>
</html>
